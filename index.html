<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Fusion Studios | Crafting Digital Experiences</title>
    <!-- Tailwind CSS CDN for utility-first styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for a modern, clean look -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Swiper CSS for Testimonial Slider -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <!-- AOS CSS for Scroll Animations -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>
        /* Custom CSS variables for consistent gradients and refined themes */
        :root {
            --primary: #2A61FF; /* Blue */
            --secondary: #8A2BE2; /* Purple */
            --accent: #FF2A6D; /* Hot Pink */
            --gold: #FFD700; /* Gold for highlights/active states */

            /* Light Theme Colors (softer and blended) */
            --bg-color-light: #f5f7fa; /* Very light blue-gray background */
            --text-color-light: #1f2937; /* Dark gray for main text */
            --card-bg-light: rgba(255, 255, 255, 0.95); /* Near opaque white for cards */
            --card-border-light: rgba(0, 0, 0, 0.15); /* Slightly more visible border */
            --chat-bg-light: #e8ebf0; /* Light blue-gray for chat window */
            --chat-input-bg-light: #ffffff; /* Pure white for chat input */
            --light-gradient-start: #1d4ed8; /* Darker blue for light theme gradient */
            --light-gradient-end: #6d28d9; /* Darker purple for light theme gradient */
        }

        /* Dark Theme Colors */
        [data-theme='dark'] {
            --bg-color: #0d1117; /* GitHub Dark background */
            --text-color: #e6edf3; /* Light gray text */
            --card-bg: rgba(31, 48, 68, 0.4); /* Transparent dark blue-gray for cards */
            --card-border: rgba(255, 255, 255, 0.1); /* Subtle white border */
            --chat-bg: #1f3044; /* Darker blue-gray for chat window */
            --chat-input-bg: #2d3b4f; /* Even darker blue-gray for chat input */
        }

        /* Base styles that use the variables */
        body {
            background-color: var(--bg-color-light);
            color: var(--text-color-light);
            font-family: 'Poppins', 'Inter', sans-serif;
            scroll-behavior: smooth;
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth theme transition */
        }

        /* Apply Dark Theme Colors when data-theme='dark' is active */
        [data-theme='dark'] body {
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        /* Glassmorphism Card Styling */
        .glass-card {
            background: var(--card-bg-light); /* Default to light theme card bg */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--card-border-light); /* Default to light theme card border */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease-in-out;
        }
        [data-theme='dark'] .glass-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
        }
        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.2);
        }

        /* Neo-Brutal-style Button Styling (Restored to original requested design) */
        .neo-brutal-btn {
            font-weight: bold;
            font-size: 1.125rem; /* text-lg */
            padding-left: 2rem;  /* px-8 */
            padding-right: 2rem;
            padding-top: 0.75rem; /* py-3 */
            padding-bottom: 0.75rem;
            border-radius: 0.375rem; /* rounded-md */
            transition: all 0.3s;
            border-width: 2px;
            border-style: solid;
            box-shadow: 4px 4px 0px #FF2A6D; /* Fixed hot pink shadow for all modes */
            background-color: #1f3044; /* Base dark color for buttons */
            color: #e6edf3; /* Light text for buttons */
            border-color: #1f3044; /* Border matches background */
            cursor: pointer;
        }
        .neo-brutal-btn:hover {
            box-shadow: 8px 8px 0px #FF2A6D; /* Fixed hot pink shadow for all modes */
            transform: translate(-4px, -4px);
        }
        .neo-brutal-btn.primary {
            background-color: #FF2A6D; /* Fixed hot pink background for primary */
            color: #1f3044; /* Dark text for primary */
            box-shadow: 4px 4px 0px #1f3044; /* Dark shadow for primary */
            border-color: #FF2A6D; /* Border matches background for primary */
        }
        .neo-brutal-btn.primary:hover {
            box-shadow: 8px 8px 0px #1f3044;
            transform: translate(-4px, -4px);
        }
        /* No specific light mode adjustments for button colors, as per request for consistency */


        /* Gradient Text/Icons (Adjusted for better light mode contrast) */
        .gradient-text {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .gradient-icon {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        [data-theme='light'] .gradient-text,
        [data-theme='light'] .gradient-icon {
            background: linear-gradient(45deg, var(--light-gradient-start), var(--light-gradient-end));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* Hero Section Specific Styles */
        .hero-bg {
            background-image: linear-gradient(rgba(13, 17, 23, 0.9), rgba(13, 17, 23, 0.9));
            background-size: cover;
            background-position: center;
        }
        #three-canvas-header {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            /* Ensure the canvas covers the whole hero section */
        }
        #three-canvas-calculator {
            width: 100%; /* Ensure it fills container */
            height: 500px; /* Fixed height for consistency */
            display: block;
        }
        
        /* Chat UI styling */
        #chat-window {
            height: 400px;
            overflow-y: auto;
            background-color: var(--chat-bg-light); /* Default light chat bg */
            border: 1px solid var(--card-border-light); /* Default light border */
            padding: 1rem; /* p-4 */
            border-radius: 0.5rem; /* rounded-md */
            display: flex;
            flex-direction: column;
            gap: 0.5rem; /* space-y-4 */
        }
        [data-theme='dark'] #chat-window {
            background-color: var(--chat-bg);
            border: 1px solid var(--card-border);
        }
        .message {
            padding: 0.75rem; /* p-3 */
            margin-bottom: 0.5rem; /* mb-2 */
            border-radius: 0.5rem; /* rounded-lg */
            max-width: 80%;
            animation: fadeIn 0.5s ease-in-out;
            word-wrap: break-word; /* Ensure long words wrap */
        }
        .user-message {
            background-color: #3b82f6; /* bg-blue-500 */
            color: #fff; /* text-white */
            margin-left: auto; /* ml-auto */
        }
        .ai-message {
            background-color: #4b5563; /* bg-gray-600 */
            color: #fff; /* text-white */
            margin-right: auto; /* mr-auto */
        }
        [data-theme='light'] .ai-message {
            background-color: #d1d5db; /* Light gray for AI messages in light theme */
            color: #1f2937; /* Dark text for AI messages in light theme */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Loading Dots Animation for AI Estimator */
        .loading-dots {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin-right: auto;
            min-height: 24px; /* Ensure loading dots take up space */
        }
        .loading-dot-item {
            width: 8px;
            height: 8px;
            background-color: #cbd5e1; /* Lighter gray for dots */
            border-radius: 50%;
            margin: 0 3px;
            animation: bounce-dot 1.2s infinite ease-in-out;
        }
        .loading-dot-item:nth-child(2) { animation-delay: 0.16s; }
        .loading-dot-item:nth-child(3) { animation-delay: 0.32s; }

        @keyframes bounce-dot {
            0%, 80%, 100% { transform: scale(0); background-color: #94a3b8; } /* Reset color on scale 0 */
            40% { transform: scale(1); background-color: #3b82f6; } /* Blue for bounce peak */
        }

        /* Shining Navigation Effect */
        .nav-link {
            position: relative;
            padding-bottom: 5px;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        .nav-link:hover::after, .nav-link.active::after {
            transform: scaleX(1);
        }
        .nav-link.active {
            color: var(--gold);
        }

        /* Scrollbar Styling */
        html {
            scroll-behavior: smooth;
        }
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-color-light); /* Default to light theme background */
        }
        [data-theme='dark'] ::-webkit-scrollbar-track {
            background: var(--bg-color); /* Dark theme scrollbar track */
        }
        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 5px;
        }
        
        /* FIX: Ensure input text is always readable in both modes */
        input[type="text"],
        input[type="email"],
        textarea,
        #userInput {
            background-color: var(--chat-input-bg-light); /* Default to light theme input bg */
            border: 1px solid var(--card-border-light); /* Default to light theme border */
            color: var(--text-color-light); /* Default to light theme text color */
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        [data-theme='dark'] input[type="text"],
        [data-theme='dark'] input[type="email"],
        [data-theme='dark'] textarea,
        [data-theme='dark'] #userInput {
            color: var(--text-color) !important;
            background-color: var(--chat-input-bg) !important;
            border-color: var(--card-border) !important;
        }
        /* Ensure the placeholder is also readable in both modes */
        ::placeholder {
            color: #9ca3af !important; /* Neutral gray for placeholders */
            opacity: 1 !important;
        }
        :-ms-input-placeholder {
            color: #9ca3af !important;
        }
        ::-ms-input-placeholder {
            color: #9ca3af !important;
        }
    </style>
</head>
<body class="overflow-x-hidden">
    <!-- Preloader -->
    <div id="preloader" class="fixed inset-0 z-[9999] flex items-center justify-center bg-gray-900 transition-opacity duration-500 opacity-100">
        <div class="h-16 w-16 animate-spin rounded-full border-4 border-t-4 border-gray-700 border-t-blue-500"></div>
    </div>
    
    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed top-5 right-5 z-[9999] space-y-2"></div>

    <!-- Navigation Bar -->
    <nav class="fixed w-full z-50 p-4 transition-all duration-300 bg-transparent">
        <div class="container mx-auto flex justify-between items-center">
            <!-- Logo with a neo-brutal-style -->
            <a href="#" class="font-black text-3xl tracking-wider uppercase text-white">
                Digital<span class="gradient-text">Fusion</span>
            </a>
            
            <!-- Desktop Menu -->
            <ul class="hidden md:flex space-x-8 text-white text-lg font-medium">
                <li><a href="#hero" class="nav-link">Home</a></li>
                <li><a href="#services" class="nav-link">Services</a></li>
                <li><a href="#estimator" class="nav-link">Estimator</a></li>
                <li><a href="#portfolio" class="nav-link">Portfolio</a></li>
                <li><a href="#about" class="nav-link">About</a></li>
                <li><a href="#faq" class="nav-link">FAQ</a></li>
                <li><a href="#contact" class="nav-link">Contact</a></li>
                <!-- Theme Toggle Button -->
                <button id="themeToggle" class="text-white hover:text-gold transition-colors duration-200">
                    <i class="fas fa-moon"></i>
                </button>
            </ul>

            <!-- Mobile Menu Button -->
            <div class="flex items-center space-x-4 md:hidden">
                <button id="menuBtn" class="text-white focus:outline-none">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
                <button id="themeToggleMobile" class="text-white focus:outline-none">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>
    
    <!-- Mobile Drawer Menu -->
    <div id="mobileMenu" class="fixed top-0 left-0 w-full h-full bg-gray-900 bg-opacity-95 z-[999] transform translate-x-full transition-transform duration-300 ease-in-out">
        <div class="p-8 flex flex-col h-full">
            <button id="closeMenu" class="self-end text-white text-3xl">&times;</button>
            <ul class="flex flex-col items-center justify-center space-y-8 flex-grow">
                <li><a href="#hero" class="drawer-link text-4xl text-white font-bold hover:text-gold">Home</a></li>
                <li><a href="#services" class="drawer-link text-4xl text-white font-bold hover:text-gold">Services</a></li>
                <li><a href="#estimator" class="drawer-link text-4xl text-white font-bold hover:text-gold">Estimator</a></li>
                <li><a href="#portfolio" class="drawer-link text-4xl text-white font-bold hover:text-gold">Portfolio</a></li>
                <li><a href="#about" class="drawer-link text-4xl text-white font-bold hover:text-gold">About</a></li>
                <li><a href="#faq" class="drawer-link text-4xl text-white font-bold hover:text-gold">FAQ</a></li>
                <li><a href="#contact" class="drawer-link text-4xl text-white font-bold hover:text-gold">Contact</a></li>
            </ul>
        </div>
    </div>
    
    <main>
        <!-- Hero Section with 3D animation -->
        <section id="hero" class="hero-bg relative h-screen flex items-center justify-center text-center px-4 overflow-hidden">
            <canvas id="three-canvas-header" class="absolute inset-0"></canvas>
            <div class="relative z-10 space-y-6" data-aos="fade-up">
                <h1 class="text-4xl sm:text-6xl lg:text-7xl font-extrabold text-white leading-tight">
                    <span class="block gradient-text">WE CRAFT</span> DIGITAL EXPERIENCES
                </h1>
                <p id="typewriter" class="text-lg sm:text-xl text-gray-300 max-w-2xl mx-auto min-h-[30px]"></p>
                <div class="flex flex-col sm:flex-row justify-center items-center gap-4 pt-4" data-aos="fade-up" data-aos-delay="300">
                    <a href="#contact" class="neo-brutal-btn primary">Start a Project</a>
                    <a href="#portfolio" class="neo-brutal-btn">View Our Work</a>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="services" class="container mx-auto py-24 px-4 text-center">
            <h2 class="text-4xl font-bold text-white mb-16 gradient-text" data-aos="fade-up">Our Core Services</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="p-8 rounded-lg glass-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="text-4xl mb-4 gradient-icon"><i class="fas fa-code"></i></div>
                    <h3 class="text-2xl font-bold text-text-color mb-2">Web Development</h3>
                    <p class="text-text-color">We build high-performance, scalable websites and applications using modern technologies, ensuring responsive design and optimal user experience.</p>
                </div>
                <div class="p-8 rounded-lg glass-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="text-4xl mb-4 gradient-icon"><i class="fas fa-paint-brush"></i></div>
                    <h3 class="text-2xl font-bold text-text-color mb-2">UI/UX Design</h3>
                    <p class="text-text-color">We align visual identity with your brand's core mission, creating designs that tell a compelling story and provide seamless, intuitive user interactions.</p>
                </div>
                <div class="p-8 rounded-lg glass-card" data-aos="fade-up" data-aos-delay="300">
                    <div class="text-4xl mb-4 gradient-icon"><i class="fas fa-bullhorn"></i></div>
                    <h3 class="text-2xl font-bold text-text-color mb-2">Digital Marketing & SEO</h3>
                    <p class="text-text-color">We develop full-scale branding packages and data-driven digital marketing strategies that stand out, including comprehensive SEO to boost your online visibility.</p>
                </div>
            </div>
            <!-- Added more services for a longer website -->
            <div class="mt-16 grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="p-8 rounded-lg glass-card" data-aos="fade-up" data-aos-delay="400">
                    <div class="text-4xl mb-4 gradient-icon"><i class="fas fa-mobile-alt"></i></div>
                    <h3 class="text-2xl font-bold text-text-color mb-2">Mobile App Development</h3>
                    <p class="text-text-color">From concept to launch, we build intuitive and robust mobile applications for iOS and Android platforms, enhancing your reach and user engagement.</p>
                </div>
                <div class="p-8 rounded-lg glass-card" data-aos="fade-up" data-aos-delay="500">
                    <div class="text-4xl mb-4 gradient-icon"><i class="fas fa-cloud"></i></div>
                    <h3 class="text-2xl font-bold text-text-color mb-2">Cloud Solutions & Hosting</h3>
                    <p class="text-text-color">We provide secure, scalable cloud infrastructure and hosting solutions, ensuring your applications are always available, performant, and reliable.</p>
                </div>
            </div>
        </section>

        <!-- AI Project Estimator Section -->
        <section id="estimator" class="container mx-auto py-24 px-4">
            <h2 class="text-4xl font-bold text-white mb-16 text-center gradient-text" data-aos="fade-up">AI Project Estimator</h2>
            <div class="text-center mb-8 max-w-3xl mx-auto" data-aos="fade-up" data-aos-delay="100">
                <p class="text-lg text-gray-300">
                    Describe your project to our AI assistant to get an instant cost estimate. Tell us about the type of website, the features you need, and any other requirements.
                </p>
            </div>
            <div class="flex flex-col lg:flex-row gap-12 items-center">
                <!-- AI Calculator UI -->
                <div class="glass-card p-8 rounded-lg flex flex-col h-[500px] w-full lg:w-1/2" data-aos="fade-right">
                    <h3 class="text-2xl font-bold text-text-color mb-4 text-center">Get Your Instant Quote</h3>
                    <div id="chat-window" class="flex-grow overflow-y-auto mb-4 p-4 rounded-md space-y-4">
                        <!-- Initial AI Message is injected by JS -->
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="userInput" placeholder="I need a simple one-page portfolio website..." class="w-full p-3 rounded-md bg-chat-input-bg text-text-color focus:outline-none focus:ring-2 focus:ring-gold" required>
                        <button id="sendBtn" class="neo-brutal-btn primary px-4 py-2">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>

                <!-- Calculator Animation Canvas -->
                <div class="relative w-full h-[500px] md:block hidden lg:w-1/2 rounded-lg overflow-hidden glass-card" data-aos="fade-left">
                    <canvas id="three-canvas-calculator" class="absolute inset-0 w-full h-full"></canvas>
                </div>
            </div>
        </section>

        <!-- Stats Counter Section -->
        <section id="stats" class="bg-gray-800 py-16">
            <div class="container mx-auto px-4">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 text-center">
                    <div class="flex flex-col items-center" data-aos="fade-up">
                        <span class="counter text-5xl font-bold gradient-text" data-target="150">0</span>
                        <p class="text-white mt-2">Projects Completed</p>
                    </div>
                    <div class="flex flex-col items-center" data-aos="fade-up" data-aos-delay="100">
                        <span class="counter text-5xl font-bold gradient-text" data-target="75">0</span>
                        <p class="text-white mt-2">Happy Clients</p>
                    </div>
                    <div class="flex flex-col items-center" data-aos="fade-up" data-aos-delay="200">
                        <span class="counter text-5xl font-bold gradient-text" data-target="50000">0</span>
                        <p class="text-white mt-2">Lines of Code</p>
                    </div>
                    <div class="flex flex-col items-center" data-aos="fade-up" data-aos-delay="300">
                        <span class="counter text-5xl font-bold gradient-text" data-target="10">0</span>
                        <p class="text-white mt-2">Years of Experience</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Portfolio Section -->
        <section id="portfolio" class="container mx-auto py-24 px-4 text-center">
            <h2 class="text-4xl font-bold text-white mb-12 gradient-text" data-aos="fade-up">Our Featured Work</h2>
            <div class="flex flex-wrap justify-center gap-4 mb-16" data-aos="fade-up" data-aos-delay="200">
                <button data-filter="all" class="filter-btn text-gold font-bold text-lg px-4 py-2 rounded-md transition-colors">All</button>
                <button data-filter="web" class="filter-btn text-text-color hover:text-gold font-medium text-lg px-4 py-2 rounded-md transition-colors">Web Dev</button>
                <button data-filter="design" class="filter-btn text-text-color hover:text-gold font-medium text-lg px-4 py-2 rounded-md transition-colors">UI/UX Design</button>
                <button data-filter="branding" class="filter-btn text-text-color hover:text-gold font-medium text-lg px-4 py-2 rounded-md transition-colors">Branding</button>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="portfolio-item web design rounded-lg overflow-hidden glass-card relative" data-aos="fade-up">
                    <img src="images/portfolio/enterprise-solution.jpg" onerror="this.onerror=null;this.src='https://placehold.co/600x400/2A61FF/FFFFFF?text=Enterprise+Solution';" alt="Enterprise Solution" class="w-full h-auto object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-text-color">Enterprise Web Platform</h3>
                        <p class="text-text-color">A robust and scalable web platform for large enterprises, focusing on secure data management and user access.</p>
                    </div>
                </div>
                <div class="portfolio-item design branding rounded-lg overflow-hidden glass-card" data-aos="fade-up" data-aos-delay="100">
                    <img src="images/portfolio/startup-brand-launch.jpg" onerror="this.onerror=null;this.src='https://placehold.co/600x400/8A2BE2/FFFFFF?text=Startup+Brand+Launch';" alt="Startup Brand Launch" class="w-full h-auto object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-text-color">Full Startup Brand Launch</h3>
                        <p class="text-text-color">From concept to market, we crafted a compelling brand identity and digital presence for a tech startup.</p>
                    </div>
                </div>
                <div class="portfolio-item web rounded-lg overflow-hidden glass-card" data-aos="fade-up" data-aos-delay="200">
                    <img src="images/portfolio/e-commerce-redesign.jpg" onerror="this.onerror=null;this.src='https://placehold.co/600x400/FF2A6D/FFFFFF?text=E-commerce+Redesign';" alt="E-commerce Redesign" class="w-full h-auto object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-text-color">E-commerce Experience Redesign</h3>
                        <p class="text-text-color">Revamping an existing e-commerce site to improve user flow, conversion rates, and overall aesthetic appeal.</p>
                    </div>
                </div>
                <div class="portfolio-item branding web rounded-lg overflow-hidden glass-card" data-aos="fade-up" data-aos-delay="300">
                    <img src="images/portfolio/saas-dashboard-ui.jpg" onerror="this.onerror=null;this.src='https://placehold.co/600x400/FFD700/000000?text=SaaS+Dashboard+UI';" alt="SaaS Dashboard UI" class="w-full h-auto object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-text-color">Intuitive SaaS Dashboard UI</h3>
                        <p class="text-text-color">Designing and developing a user-friendly dashboard for a Software-as-a-Service (SaaS) application, focusing on data visualization and ease of use.</p>
                    </div>
                </div>
                 <div class="portfolio-item web rounded-lg overflow-hidden glass-card" data-aos="fade-up" data-aos-delay="400">
                    <img src="images/portfolio/cross-platform-mobile-app.jpg" onerror="this.onerror=null;this.src='https://placehold.co/600x400/1D4ED8/FFFFFF?text=Mobile+App+Concept';" alt="Mobile App Concept" class="w-full h-auto object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-text-color">Cross-Platform Mobile Application</h3>
                        <p class="text-text-color">Developing a native-like mobile application for both iOS and Android, ensuring consistent experience and performance.</p>
                    </div>
                </div>
                 <div class="portfolio-item design rounded-lg overflow-hidden glass-card" data-aos="fade-up" data-aos-delay="500">
                    <img src="images/portfolio/interactive-portfolio.jpg" onerror="this.onerror=null;this.src='https://placehold.co/600x400/6D28D9/FFFFFF?text=Interactive+Portfolio';" alt="Interactive Portfolio" class="w-full h-auto object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-text-color">Personalized Interactive Portfolio</h3>
                        <p class="text-text-color">Crafting a dynamic and engaging online portfolio to showcase creative work with unique animations and transitions.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section id="testimonials" class="bg-gray-800 py-24 px-4">
            <h2 class="text-4xl font-bold text-white mb-16 text-center gradient-text" data-aos="fade-up">What Our Clients Say</h2>
            <div class="container mx-auto max-w-3xl" data-aos="fade-up" data-aos-delay="100">
                <!-- Swiper Testimonials Container -->
                <div class="swiper mySwiper">
                    <div class="swiper-wrapper">
                        <!-- Testimonial Slide 1 -->
                        <div class="swiper-slide p-8 rounded-lg glass-card flex flex-col items-center text-center">
                            <img src="images/clients/jane-doe.jpg" onerror="this.onerror=null;this.src='https://placehold.co/100x100/2A61FF/FFFFFF?text=Client+A';" alt="Client 1" class="rounded-full w-24 h-24 mb-4 object-cover">
                            <p class="text-lg text-text-color italic mb-4">"Digital Fusion Studios completely transformed our online presence. The new website is not only beautiful but incredibly fast and easy to use. Highly recommended!"</p>
                            <h4 class="text-xl font-bold text-text-color">- Jane Doe, CEO of TechCorp</h4>
                        </div>
                        <!-- Testimonial Slide 2 -->
                        <div class="swiper-slide p-8 rounded-lg glass-card flex flex-col items-center text-center">
                            <img src="images/clients/marcus-ray.jpg" onerror="this.onerror=null;this.src='https://placehold.co/100x100/8A2BE2/FFFFFF?text=Client+B';" alt="Client 2" class="rounded-full w-24 h-24 mb-4 object-cover">
                            <p class="text-lg text-text-color italic mb-4">"The team at Digital Fusion Studios is a pleasure to work with. They listened to our needs and delivered a branding package that perfectly captured our vision."</p>
                            <h4 class="text-xl font-bold text-text-color">- Marcus Ray, Founder of BrandWave</h4>
                        </div>
                        <!-- Testimonial Slide 3 -->
                        <div class="swiper-slide p-8 rounded-lg glass-card flex flex-col items-center text-center">
                            <img src="images/clients/emily-chen.jpg" onerror="this.onerror=null;this.src='https://placehold.co/100x100/FF2A6D/FFFFFF?text=Client+C';" alt="Client 3" class="rounded-full w-24 h-24 mb-4 object-cover">
                            <p class="text-lg text-text-color italic mb-4">"Their web development skills are top-notch. They built a custom e-commerce solution for us that has significantly boosted our sales. A fantastic partnership!"</p>
                            <h4 class="text-xl font-bold text-text-color">- Emily Chen, Director of E-Sales</h4>
                        </div>
                    </div>
                     <!-- Add Pagination -->
                    <div class="swiper-pagination"></div>
                    <!-- Add Navigation (Arrows) -->
                    <div class="swiper-button-next text-white"></div>
                    <div class="swiper-button-prev text-white"></div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="container mx-auto py-24 px-4 text-center">
            <h2 class="text-4xl font-bold text-white mb-16 gradient-text" data-aos="fade-up">About Digital Fusion Studios</h2>
            <div class="max-w-4xl mx-auto p-8 rounded-lg glass-card" data-aos="fade-up" data-aos-delay="100">
                <p class="text-lg text-text-color leading-relaxed mb-6" data-aos="fade-up" data-aos-delay="200">
                    Digital Fusion Studios is a collective of passionate innovators, dedicated to shaping the digital landscape with cutting-edge web solutions. With over a decade of combined experience, we specialize in transforming visionary ideas into tangible, high-impact digital products. Our expertise spans responsive web development, intuitive UI/UX design, powerful branding, and strategic digital marketing.
                </p>
                <p class="text-lg text-text-color leading-relaxed mb-6" data-aos="fade-up" data-aos-delay="300">
                    We pride ourselves on a collaborative approach, working closely with clients to understand their unique challenges and aspirations. Our philosophy is simple: combine exceptional design with robust technology to create online experiences that are not only aesthetically pleasing but also highly functional, scalable, and tailored to drive measurable results. We are committed to pixel-perfect quality and a relentless pursuit of innovation in every project we undertake.
                </p>
                <div class="flex justify-center gap-4 text-text-color" data-aos="fade-up" data-aos-delay="400">
                    <div class="text-2xl gradient-icon">🏆</div>
                    <div class="text-2xl gradient-icon">✨</div>
                    <div class="text-2xl gradient-icon">🚀</div>
                </div>
            </div>
            <!-- Added "Our Values" section for more content -->
            <div class="mt-20">
                <h3 class="text-3xl font-bold text-white mb-10 gradient-text" data-aos="fade-up">Our Core Values</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                    <div class="p-6 rounded-lg glass-card" data-aos="zoom-in" data-aos-delay="100">
                        <i class="fas fa-lightbulb text-4xl gradient-icon mb-4"></i>
                        <h4 class="text-xl font-bold text-text-color mb-2">Innovation</h4>
                        <p class="text-text-color">Continuously exploring new technologies and creative approaches to deliver groundbreaking solutions.</p>
                    </div>
                    <div class="p-6 rounded-lg glass-card" data-aos="zoom-in" data-aos-delay="200">
                        <i class="fas fa-handshake text-4xl gradient-icon mb-4"></i>
                        <h4 class="text-xl font-bold text-text-color mb-2">Collaboration</h4>
                        <p class="text-text-color">Building strong, transparent partnerships with clients through transparent and open communication.</p>
                    </div>
                    <div class="p-6 rounded-lg glass-card" data-aos="zoom-in" data-aos-delay="300">
                        <i class="fas fa-cogs text-4xl gradient-icon mb-4"></i>
                        <h4 class="text-xl font-bold text-text-color mb-2">Excellence</h4>
                        <p class="text-text-color">Committing to the highest standards of quality, precision, and attention to detail in every aspect of our work.</p>
                    </div>
                </div>
            </div>
             <!-- Added "Why Choose Us" section for more content -->
            <div class="mt-20">
                <h3 class="text-3xl font-bold text-white mb-10 gradient-text" data-aos="fade-up">Why Choose Digital Fusion Studios?</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    <div class="p-6 rounded-lg glass-card text-left" data-aos="fade-right" data-aos-delay="100">
                        <i class="fas fa-chart-line text-4xl gradient-icon mb-4"></i>
                        <h4 class="text-xl font-bold text-text-color mb-2">Results-Driven Approach</h4>
                        <p class="text-text-color">Our focus is not just on building beautiful websites, but on creating digital solutions that deliver tangible business results and ROI.</p>
                    </div>
                    <div class="p-6 rounded-lg glass-card text-left" data-aos="fade-left" data-aos-delay="200">
                        <i class="fas fa-users text-4xl gradient-icon mb-4"></i>
                        <h4 class="text-xl font-bold text-text-color mb-2">Expert Team</h4>
                        <p class="text-text-color">Benefit from a multidisciplinary team of designers, developers, and strategists passionate about your success.</p>
                    </div>
                    <div class="p-6 rounded-lg glass-card text-left" data-aos="fade-right" data-aos-delay="300">
                        <i class="fas fa-shield-alt text-4xl gradient-icon mb-4"></i>
                        <h4 class="text-xl font-bold text-text-color mb-2">Future-Proof Solutions</h4>
                        <p class="text-text-color">We build with scalability and maintainability in mind, ensuring your digital presence can grow with your business.</p>
                    </div>
                    <div class="p-6 rounded-lg glass-card text-left" data-aos="fade-left" data-aos-delay="400">
                        <i class="fas fa-hand-holding-heart text-4xl gradient-icon mb-4"></i>
                        <h4 class="text-xl font-bold text-text-color mb-2">Client-Centric Process</h4>
                        <p class="text-text-color">Your satisfaction is our priority. We involve you at every step, ensuring clear communication and tailored solutions.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- FAQ Section -->
        <section id="faq" class="container mx-auto py-24 px-4">
            <h2 class="text-4xl font-bold text-white mb-16 text-center gradient-text" data-aos="fade-up">Frequently Asked Questions</h2>
            <div class="max-w-3xl mx-auto space-y-4">
                <!-- FAQ Item 1 -->
                <div class="rounded-lg p-6 glass-card" data-aos="fade-up">
                    <div class="flex justify-between items-center cursor-pointer faq-toggle">
                        <h4 class="text-xl font-bold text-text-color">What is your design process?</h4>
                        <i class="fas fa-chevron-down transform transition-transform duration-300 text-text-color"></i>
                    </div>
                    <div class="faq-content hidden mt-4 text-text-color">
                        <p>Our process typically starts with a comprehensive discovery phase to understand your unique needs and goals. This is followed by wireframing, design mockups, iterative development, and rigorous testing. We value client feedback at every stage to ensure the final product perfectly aligns with your vision.</p>
                    </div>
                </div>
                <!-- FAQ Item 2 -->
                <div class="rounded-lg p-6 glass-card" data-aos="fade-up" data-aos-delay="100">
                    <div class="flex justify-between items-center cursor-pointer faq-toggle">
                        <h4 class="text-xl font-bold text-text-color">How long does a typical project take?</h4>
                        <i class="fas fa-chevron-down transform transition-transform duration-300 text-text-color"></i>
                    </div>
                    <div class="faq-content hidden mt-4 text-text-color">
                        <p>Project timelines vary significantly based on scope and complexity. A simple informational website might take 4-6 weeks, while a complex e-commerce platform or custom application could take several months. After our initial consultation, we provide a detailed project roadmap with estimated timelines.</p>
                    </div>
                </div>
                <!-- FAQ Item 3 -->
                <div class="rounded-lg p-6 glass-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="flex justify-between items-center cursor-pointer faq-toggle">
                        <h4 class="text-xl font-bold text-text-color">Do you offer ongoing support and maintenance?</h4>
                        <i class="fas fa-chevron-down transform transition-transform duration-300 text-text-color"></i>
                    </div>
                    <div class="faq-content hidden mt-4 text-text-color">
                        <p>Absolutely! We offer various post-launch support and maintenance packages to ensure your website or application remains secure, up-to-date, and performing optimally. This includes regular updates, security monitoring, bug fixes, and performance enhancements.</p>
                    </div>
                </div>
                 <!-- FAQ Item 4 -->
                 <div class="rounded-lg p-6 glass-card" data-aos="fade-up" data-aos-delay="300">
                    <div class="flex justify-between items-center cursor-pointer faq-toggle">
                        <h4 class="text-xl font-bold text-text-color">What is your pricing model?</h4>
                        <i class="fas fa-chevron-down transform transition-transform duration-300 text-text-color"></i>
                    </div>
                    <div class="faq-content hidden mt-4 text-text-color">
                        <p>Our pricing is project-based, tailored to the specific requirements and complexity of your project. We offer transparent pricing and detailed proposals after an initial consultation. For a quick estimate, try our AI Project Estimator on this page!</p>
                    </div>
                </div>
                 <!-- FAQ Item 5 (Added for more content) -->
                 <div class="rounded-lg p-6 glass-card" data-aos="fade-up" data-aos-delay="400">
                    <div class="flex justify-between items-center cursor-pointer faq-toggle">
                        <h4 class="text-xl font-bold text-text-color">Can you help with content creation?</h4>
                        <i class="fas fa-chevron-down transform transition-transform duration-300 text-text-color"></i>
                    </div>
                    <div class="faq-content hidden mt-4 text-text-color">
                        <p>While our primary focus is design and development, we can connect you with trusted partners for high-quality content creation, including copywriting, photography, and video production, to ensure your website is fully equipped.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="container mx-auto py-24 px-4 text-center">
            <h2 class="text-4xl font-bold text-white mb-16 gradient-text" data-aos="fade-up">Get in Touch</h2>
            <div class="max-w-xl mx-auto p-8 rounded-lg glass-card" data-aos="fade-up" data-aos-delay="100">
                <p class="text-lg text-text-color mb-8">Have a project in mind or just want to chat? We'd love to hear from you!</p>
                <form id="contactForm" class="space-y-6">
                    <div>
                        <input type="text" id="name" placeholder="Your Name" class="w-full p-3 rounded-md focus:outline-none focus:ring-2 focus:ring-gold" required>
                    </div>
                    <div>
                        <input type="email" id="email" placeholder="Your Email" class="w-full p-3 rounded-md focus:outline-none focus:ring-2 focus:ring-gold" required>
                    </div>
                    <div>
                        <textarea id="message" placeholder="Your Message" rows="5" class="w-full p-3 rounded-md focus:outline-none focus:ring-2 focus:ring-gold" required></textarea>
                    </div>
                    <button type="submit" class="neo-brutal-btn primary w-full">Send Message</button>
                    <div id="formMessage" class="mt-4 text-sm font-semibold text-center text-text-color"></div>
                </form>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 py-12 px-4 text-center">
        <div class="container mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <a href="#" class="font-black text-3xl tracking-wider uppercase text-white">
                    Digital<span class="gradient-text">Fusion</span>
                </a>
                <ul class="flex flex-wrap justify-center md:space-x-8 mt-4 md:mt-0 text-white font-medium">
                    <li><a href="#services" class="hover:text-gold transition-colors duration-200">Services</a></li>
                    <li><a href="#estimator" class="hover:text-gold transition-colors duration-200">Estimator</a></li>
                    <li><a href="#portfolio" class="hover:text-gold transition-colors duration-200">Portfolio</a></li>
                    <li><a href="#about" class="hover:text-gold transition-colors duration-200">About</a></li>
                    <li><a href="#faq" class="hover:text-gold transition-colors duration-200">FAQ</a></li>
                    <li><a href="#contact" class="hover:text-gold transition-colors duration-200">Contact</a></li>
                </ul>
            </div>
            <p class="text-gray-500 text-sm mt-8">&copy; <span id="year"></span> Digital Fusion Studios. All rights reserved.</p>
        </div>
    </footer>

    <!-- JavaScript Dependencies -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <!-- Firebase SDKs (Required for contact form database submission) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // 🚨🚨🚨 YOUR Firebase Configuration IS NOW INSERTED HERE! 🚨🚨🚨
        // This object comes directly from your Firebase project console.
        let firebaseConfig = {
            apiKey: "AIzaSyA52F0dF6l0O_tQ1w4OKRcH5EQRJoPhdBM",
            authDomain: "ultrawebexperience-service.firebaseapp.com",
            projectId: "ultrawebexperience-service",
            storageBucket: "ultrawebexperience-service.firebasestorage.app",
            messagingSenderId: "248605767535",
            appId: "1:248605767535:web:e2d902828db3d25284da9a",
            measurementId: "G-VP36MW16Z6" // Analytics ID, not used for Firestore directly
        };

        // This ensures the correct appId is used, especially in Canvas environments.
        if (typeof __firebase_config !== 'undefined') {
            try { firebaseConfig = JSON.parse(__firebase_config); } catch (e) { console.error("Canvas Firebase config parsing failed:", e); }
        }
        // Use projectId as appId if __app_id is not defined, for local consistency.
        const appId = typeof __app_id !== 'undefined' ? __app_id : firebaseConfig.projectId || 'default-app-id';
        
        let auth, db;
        let isFirebaseReady = false;
        
        async function setupFirebase() {
            // Check if essential Firebase config details are provided (and not still placeholders or empty)
            if (firebaseConfig && firebaseConfig.projectId && firebaseConfig.apiKey && firebaseConfig.apiKey.length > 10) { 
                try {
                    const app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);
                    
                    // Wait for authentication state to be determined
                    await new Promise((resolve) => {
                        const unsubscribe = onAuthStateChanged(auth, async (user) => {
                            if (user) {
                                console.log("Firebase: User signed in with UID:", user.uid);
                                isFirebaseReady = true;
                            } else {
                                console.log("Firebase: No user signed in. Attempting anonymous sign-in...");
                                try {
                                    // Use __initial_auth_token if available (from Canvas environment)
                                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                                        await signInWithCustomToken(auth, __initial_auth_token);
                                    } else {
                                        // Otherwise, sign in anonymously for local testing
                                        await signInAnonymously(auth);
                                    }
                                    if (auth.currentUser) {
                                        console.log("Firebase: Signed in anonymously with UID:", auth.currentUser.uid);
                                        isFirebaseReady = true;
                                    }
                                } catch (error) {
                                    console.error("Firebase Auth Error during anonymous sign-in:", error);
                                    showToast("Firebase Auth Error: Please check your Firebase API Key in index.html.", "error");
                                }
                            }
                            unsubscribe(); // Unsubscribe after first auth state resolved
                            resolve();
                        });
                    });
                } catch (error) {
                    console.error("Firebase initialization failed:", error);
                    showToast("Error initializing Firebase. Contact form will not submit.", "error");
                }
            } else {
                console.warn("Firebase initialization skipped: No valid configuration provided (or API Key is too short/default). Contact form submissions will NOT be saved.");
                showToast("Firebase not configured. Contact form submissions will NOT be saved. Please update 'firebaseConfig' in index.html.", "warning");
            }
        }

        async function handleContactFormSubmit(event) {
            event.preventDefault();
            const formMessage = document.getElementById('formMessage');
            formMessage.textContent = 'Sending message...';
            formMessage.classList.remove('text-green-500', 'text-red-500');
            formMessage.classList.add('text-gray-600'); // Neutral color for sending

            // Ensure Firebase is ready and user is authenticated
            if (!isFirebaseReady || !auth || !auth.currentUser) { 
                formMessage.textContent = 'Error: Database not ready or user not authenticated. Please ensure Firebase is set up correctly in index.html.';
                formMessage.classList.remove('text-gray-600');
                formMessage.classList.add('text-red-500');
                showToast("Error sending message. Firebase not ready.", "error");
                return;
            }

            try {
                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const message = document.getElementById('message').value;

                // Firestore path based on appId and public data rules
                const collectionPath = `artifacts/${appId}/public/data/contacts`;
                
                await addDoc(collection(db, collectionPath), {
                    name,
                    email,
                    message,
                    timestamp: serverTimestamp(),
                    userId: auth.currentUser.uid // Use the authenticated user's UID
                });

                formMessage.textContent = 'Message sent successfully! We will get back to you soon.';
                formMessage.classList.remove('text-gray-600', 'text-red-500');
                formMessage.classList.add('text-green-500');
                document.getElementById('contactForm').reset();
                showToast("Message sent successfully!", "success");

            } catch (e) {
                console.error("Error adding document to Firestore: ", e);
                formMessage.textContent = 'Error sending message. Please try again.';
                formMessage.classList.remove('text-gray-600', 'text-green-500');
                formMessage.classList.add('text-red-500');
                showToast("Error sending message. See console for error details.", "error");
            }
        }

        // Initialize Firebase when the DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            setupFirebase();
            const contactForm = document.getElementById('contactForm');
            if (contactForm) {
                contactForm.addEventListener('submit', handleContactFormSubmit);
            }
        });

        // Toast Notification function
        function showToast(message, type) {
            const container = document.getElementById('toast-container');
            if (!container) return;
            const toast = document.createElement('div');
            toast.className = `p-4 rounded-md shadow-lg text-white font-semibold transition-transform transform translate-x-full duration-300 ease-out ${type === 'success' ? 'bg-green-500' : type === 'warning' ? 'bg-yellow-500' : 'bg-red-500'}`;
            toast.textContent = message;
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.remove('translate-x-full');
                toast.classList.add('translate-x-0');
            }, 100);

            setTimeout(() => {
                toast.classList.remove('translate-x-0');
                toast.classList.add('translate-x-full');
                toast.addEventListener('transitionend', () => toast.remove());
            }, 5000);
        }
    </script>

    <!-- Main Application JavaScript (Non-module scripts) -->
    <script>
        // --- Pre-loader ---
        window.addEventListener('load', () => {
            const preloader = document.getElementById('preloader');
            if (preloader) {
                preloader.style.opacity = '0';
                setTimeout(() => {
                    preloader.classList.add('hidden');
                }, 500);
            }
        });

        // --- Theme Toggle ---
        const themeToggle = document.getElementById('themeToggle');
        const themeToggleMobile = document.getElementById('themeToggleMobile');
        const html = document.documentElement;
        
        function toggleTheme() {
            const newTheme = html.dataset.theme === 'dark' ? 'light' : 'dark';
            html.dataset.theme = newTheme;
            document.querySelectorAll('#themeToggle i, #themeToggleMobile i').forEach(icon => {
                icon.classList.toggle('fa-sun');
                icon.classList.toggle('fa-moon');
            });
            // Update the state of the initial AI message in chat window if it exists
            const initialAiMessage = document.querySelector('#chat-window > .ai-message');
            if (initialAiMessage && initialAiMessage.textContent.includes("Hello! I am your AI project estimator.")) {
                initialAiMessage.remove(); // Remove old one
                const newInitialAiMessage = document.createElement('div');
                newInitialAiMessage.textContent = "Hello! I am your AI project estimator. Tell me about your dream website and I'll give you a cost estimate.";
                newInitialAiMessage.className = 'message ai-message';
                document.getElementById('chat-window').prepend(newInitialAiMessage); // Add new one to re-apply theme classes
            }
        }
        if (themeToggle) themeToggle.onclick = toggleTheme;
        if (themeToggleMobile) themeToggleMobile.onclick = toggleTheme;

        // --- Mobile Drawer ---
        const menuBtn = document.getElementById('menuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        const closeMenu = document.getElementById('closeMenu');

        if (menuBtn) menuBtn.onclick = () => mobileMenu.classList.remove('translate-x-full');
        if (closeMenu) closeMenu.onclick = () => mobileMenu.classList.add('translate-x-full');

        document.querySelectorAll('.drawer-link').forEach(link =>
            link.addEventListener('click', () => mobileMenu.classList.add('translate-x-full'))
        );

        // --- Smooth Scroll Active Links ---
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('section');
        window.onscroll = () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= sectionTop - window.innerHeight / 3) { 
                    current = section.getAttribute('id');
                }
            });
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').includes(current)) {
                    link.classList.add('active');
                }
            });
        };

        // --- Typewriter ---
        const phrases = ['We Design.', 'We Code.', 'We Innovate.', 'Your Digital Partner.'];
        let i = 0, j = 0, currentPhrase = [], isDeleting = false, isEnd = false;

        function loop() {
            const typewriter = document.getElementById('typewriter');
            if (!typewriter) return;

            isEnd = false;
            typewriter.innerHTML = currentPhrase.join('');

            if (i < phrases.length) {
                if (!isDeleting && j < phrases[i].length) {
                    currentPhrase.push(phrases[i][j]);
                    j++;
                }

                if (isDeleting && j >= 0) {
                    currentPhrase.pop();
                    j--;
                }

                if (j === phrases[i].length && !isDeleting) {
                    isEnd = true;
                    isDeleting = true;
                }

                if (isDeleting && j === 0) {
                    currentPhrase = [];
                    isDeleting = false;
                    i++;
                    if (i === phrases.length) i = 0;
                }
            }
            const spedUp = Math.random() * (80 - 50) + 50;
            const normalSpeed = Math.random() * (300 - 200) + 200;
            const time = isEnd ? 2000 : isDeleting ? spedUp : normalSpeed;
            setTimeout(loop, time);
        }
        loop();

        // --- AOS Init ---
        AOS.init({ once: true, duration: 700 });

        // --- Counter Animation ---
        const counters = document.querySelectorAll('.counter');
        const speed = 2000; // Total time in milliseconds for the animation
        const counterObserver = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const counter = entry.target;
                    const updateCount = () => {
                        const target = +counter.dataset.target;
                        let currentCount = +counter.innerText;
                        const increment = target / (speed / 16); // Increment per frame (approx 60fps)

                        if (currentCount < target) {
                            currentCount = Math.min(target, currentCount + increment); 
                            counter.innerText = Math.ceil(currentCount);
                            requestAnimationFrame(updateCount); // Use requestAnimationFrame for smoother animation
                        } else {
                            counter.innerText = target; 
                        }
                    };
                    updateCount();
                    counterObserver.unobserve(counter); // Stop observing once animated
                }
            });
        }, { threshold: 0.5 }); // Trigger when 50% of the element is visible
        counters.forEach(c => counterObserver.observe(c));

        // --- Portfolio Filter ---
        const filterBtns = document.querySelectorAll('.filter-btn');
        const portfolioItems = document.querySelectorAll('.portfolio-item');

        filterBtns.forEach(btn =>
            btn.addEventListener('click', () => {
                filterBtns.forEach(b => b.classList.remove('text-gold', 'font-bold'));
                btn.classList.add('text-gold', 'font-bold');
                const filter = btn.dataset.filter;
                portfolioItems.forEach(item => {
                    if (filter === 'all' || item.classList.contains(filter)) {
                        item.classList.remove('hidden');
                        item.classList.add('block'); // Ensure it's displayed as a block
                    } else {
                        item.classList.add('hidden');
                        item.classList.remove('block');
                    }
                });
            })
        );
        // Trigger 'All' filter on page load to show all items initially
        document.querySelector('.filter-btn[data-filter="all"]').click();

        // --- FAQ Accordion ---
        document.querySelectorAll('.faq-toggle').forEach(toggle =>
            toggle.addEventListener('click', () => {
                const content = toggle.nextElementSibling;
                const icon = toggle.querySelector('i');

                // Close all other open FAQs
                document.querySelectorAll('.faq-content').forEach(otherContent => {
                    if (otherContent !== content && !otherContent.classList.contains('hidden')) {
                        otherContent.classList.add('hidden');
                        otherContent.previousElementSibling.querySelector('i').classList.remove('rotate-180');
                    }
                });

                // Toggle the clicked FAQ
                content.classList.toggle('hidden');
                icon.classList.toggle('rotate-180');
            })
        );

        // --- Swiper Testimonials (Initialization moved to window.onload for better loading) ---
        // Swiper is initialized in window.onload now.

        // --- Dynamic Year ---
        document.getElementById('year').textContent = new Date().getFullYear();

        // --- Three.js Header Animation ---
        const initHeaderAnimation = () => {
            const canvas = document.getElementById('three-canvas-header');
            if (!canvas) return;

            const scene = new THREE.Scene();
            // Use window.innerWidth/Height directly for the camera aspect
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);

            // Set renderer's clear color with alpha to blend better
            renderer.setClearColor(0x000000, 0); // Transparent background to blend with hero-bg

            const colors = [new THREE.Color(0x2A61FF), new THREE.Color(0x8A2BE2), new THREE.Color(0xFF2A6D)];
            const shapes = [];
            const geometries = [
                new THREE.TorusGeometry(5, 1.5, 16, 100), 
                new THREE.BoxGeometry(8, 8, 8), 
                new THREE.OctahedronGeometry(6), 
                new THREE.SphereGeometry(4, 32, 32) 
            ];

            for (let i = 0; i < 30; i++) { 
                const material = new THREE.MeshBasicMaterial({ color: colors[Math.floor(Math.random() * colors.length)], wireframe: true, transparent: true, opacity: 0.6 });
                const geometry = geometries[Math.floor(Math.random() * geometries.length)];
                const shape = new THREE.Mesh(geometry, material);
                shape.position.set(
                    (Math.random() - 0.5) * 100, 
                    (Math.random() - 0.5) * 100,
                    (Math.random() - 0.5) * 100
                );
                shape.rotation.set(
                    Math.random() * Math.PI,
                    Math.random() * Math.PI,
                    Math.random() * Math.PI
                );
                shapes.push(shape);
                scene.add(shape);
            }

            camera.position.z = 30; 

            function animate() {
                requestAnimationFrame(animate);
                shapes.forEach(shape => {
                    shape.rotation.x += 0.003; 
                    shape.rotation.y += 0.003;
                });
                renderer.render(scene, camera);
            }

            window.addEventListener('resize', () => {
                const width = window.innerWidth;
                const height = window.innerHeight;
                renderer.setSize(width, height);
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
            });

            document.addEventListener('mousemove', (event) => {
                const mouseX = (event.clientX / window.innerWidth) * 2 - 1;
                const mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
                camera.position.x = mouseX * 10; 
                camera.position.y = mouseY * 10;
                camera.lookAt(scene.position);
            });
            animate();
        };

        // --- Three.js Calculator Animation (Upwork-like particles) ---
        const initCalculatorAnimation = () => {
            const canvas = document.getElementById('three-canvas-calculator');
            if (!canvas) return;

            const scene = new THREE.Scene();
            // Use canvas.clientWidth/Height for the camera aspect
            const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);

            // Set renderer's clear color with alpha to blend better
            renderer.setClearColor(0x000000, 0); // Transparent background

            const particles = [];
            const particleCount = 300; 
            const geometry = new THREE.TetrahedronGeometry(0.5); 
            const material = new THREE.MeshBasicMaterial({ color: 0x8A2BE2, wireframe: true, transparent: true, opacity: 0.7 }); 

            for (let i = 0; i < particleCount; i++) {
                const particle = new THREE.Mesh(geometry, material);
                particle.position.set(
                    (Math.random() - 0.5) * 60, 
                    (Math.random() - 0.5) * 60,
                    (Math.random() - 0.5) * 60
                );
                particle.velocity = new THREE.Vector3(
                    (Math.random() - 0.5) * 0.1, 
                    (Math.random() - 0.5) * 0.1,
                    (Math.random() - 0.5) * 0.1
                );
                particles.push(particle);
                scene.add(particle);
            }

            camera.position.z = 20; 

            function animateCalculator() {
                requestAnimationFrame(animateCalculator);
                particles.forEach(p => {
                    p.rotation.x += 0.03;
                    p.rotation.y += 0.03;
                    p.position.add(p.velocity);

                    // Bounce off edges
                    if (Math.abs(p.position.x) > 30) p.velocity.x *= -1;
                    if (Math.abs(p.position.y) > 30) p.velocity.y *= -1;
                    if (Math.abs(p.position.z) > 30) p.velocity.z *= -1;
                });
                renderer.render(scene, camera);
            }

            window.addEventListener('resize', () => {
                const canvas = document.getElementById('three-canvas-calculator');
                if (canvas) {
                    renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                    camera.aspect = canvas.clientWidth / canvas.clientHeight;
                    camera.updateProjectionMatrix();
                }
            });
            animateCalculator();
        };

        // --- AI Project Estimator Logic (This section will be completely re-thought later) ---
        const initAIEstimator = () => {
            const userInput = document.getElementById('userInput');
            const sendBtn = document.getElementById('sendBtn');
            const chatWindow = document.getElementById('chat-window');

            if (!userInput || !sendBtn || !chatWindow) return;

            let chatHistory = [];
            
            const loadingIndicator = document.createElement('div');
            loadingIndicator.className = 'ai-message loading-message'; 
            loadingIndicator.innerHTML = `
                <div class="loading-dots">
                    <div class="loading-dot-item"></div>
                    <div class="loading-dot-item"></div>
                    <div class="loading-dot-item"></div>
                </div>
            `;

            const initialAiMessage = document.createElement('div');
            initialAiMessage.textContent = "Hello! I am your AI project estimator. Tell me about your dream website and I'll give you a cost estimate.";
            initialAiMessage.className = 'message ai-message';
            if (chatWindow.children.length === 0) {
                chatWindow.appendChild(initialAiMessage);
            }

            async function sendMessage() {
                const userText = userInput.value.trim();
                if (userText === '') return;

                const userMessageDiv = document.createElement('div');
                userMessageDiv.textContent = userText;
                userMessageDiv.className = 'message user-message';
                chatWindow.appendChild(userMessageDiv);
                
                chatHistory.push({ role: "user", parts: [{ text: userText }] });

                userInput.value = '';
                chatWindow.appendChild(loadingIndicator);
                chatWindow.scrollTop = chatWindow.scrollHeight;

                try {
                    // Fetch call to your local backend server
                    const response = await fetch('http://localhost:3000/api/estimator', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ chatHistory: chatHistory })
                    });

                    if (!response.ok) {
                        throw new Error(`Server error: ${response.status}`);
                    }

                    const result = await response.json();
                    const aiText = result.text;
                    
                    chatHistory.push({ role: "model", parts: [{ text: aiText }] });

                    const aiMessageDiv = document.createElement('div');
                    aiMessageDiv.textContent = aiText;
                    aiMessageDiv.className = 'message ai-message';

                    if (chatWindow.contains(loadingIndicator)) {
                        chatWindow.removeChild(loadingIndicator);
                    }
                    chatWindow.appendChild(aiMessageDiv);
                } catch (error) {
                    console.error("Error from local server/AI:", error);
                    if (chatWindow.contains(loadingIndicator)) {
                        chatWindow.removeChild(loadingIndicator);
                    }
                    const errorDiv = document.createElement('div');
                    errorDiv.textContent = "Sorry, the estimator is currently unavailable due to an internal server error. Please try again later.";
                    errorDiv.className = 'message ai-message bg-red-500 text-white';
                    chatWindow.appendChild(errorDiv);
                } finally {
                    chatWindow.scrollTop = chatWindow.scrollHeight;
                }
            }

            sendBtn.addEventListener('click', sendMessage);
            userInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    sendMessage();
                }
            });
        };

        // Initialize all main components when the window loads
        window.onload = function() {
            initHeaderAnimation();
            initCalculatorAnimation();
            initAIEstimator();
            // Initialize Swiper after all other DOM content is loaded
            new Swiper(".mySwiper", {
                slidesPerView: 1,
                spaceBetween: 30,
                loop: true,
                autoplay: {
                    delay: 5000,
                    disableOnInteraction: false,
                },
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
            });
        };
    </script>
</body>
</html>
